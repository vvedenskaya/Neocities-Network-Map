<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bombay Mars LAN Map</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@10.7.0/ol.css">
  <link rel="stylesheet" href="map.css">
</head>
<body>
  <div id="app">
    <header class="header">
      <h1>Bombay Mars LAN Map</h1>
      <div class="controls">
        <button id="refresh-btn" type="button" title="Reload network data">Refresh</button>
        <label class="admin-toggle">
          <input type="checkbox" id="admin-mode" />
          <span>Admin (drag UniFi)</span>
        </label>
        <button id="export-positions-btn" class="secondary-btn" title="Export unifi_position_lookup.json">Export JSON</button>
      </div>
    </header>

    <main class="main">
      <aside class="sidebar">
        <section class="controls-group">
          <h3>Map Layers</h3>
          <div class="layer-selector">
            <label><input type="radio" name="base-layer" value="osm" checked> Streets</label>
            <label><input type="radio" name="base-layer" value="satellite"> Satellite</label>
            <label><input type="radio" name="base-layer" value="drone"> Drone Photo</label>
          </div>
        </section>

        <section class="controls-group">
          <h3>Visibility</h3>
          <label><input type="checkbox" id="layer-uisp" checked> UISP Devices</label>
          <label><input type="checkbox" id="layer-unifi" checked> UniFi Devices</label>
          <label><input type="checkbox" id="layer-wireless" checked> Wireless Links</label>
          <label><input type="checkbox" id="layer-wired" checked> Wired Links</label>
        </section>

        <section class="controls-group">
          <div class="section-header">
            <h3>Devices</h3>
            <button id="toggle-device-list" class="toggle-btn" title="Toggle Device List">▼</button>
          </div>
          <div id="device-list-container" class="collapsible-content">
            <input type="text" id="device-search" placeholder="Search devices..." class="search-input">
            <div id="device-list" class="device-list">
              <!-- Populated by JS -->
            </div>
          </div>
        </section>

        <section class="controls-group">
          <h3>Filters</h3>
          <label><input type="checkbox" id="filter-online-only"> Online Only</label>
          
          <div class="filter-range">
            <label for="filter-signal">Min Signal (dBm): <span id="signal-value">-90</span></label>
            <input type="range" id="filter-signal" min="-90" max="-40" value="-90">
          </div>
        </section>
      </aside>

      <div id="map" class="map"></div>

      <aside id="inspector" class="inspector hidden">
        <div class="inspector-header">
          <h2 id="inspector-title">Details</h2>
          <button id="inspector-close" type="button" aria-label="Close">×</button>
        </div>
        <div id="inspector-content" class="inspector-content"></div>
      </aside>
    </main>
  </div>

  <!-- Библиотека для чтения GeoTIFF — должна быть загружена до OpenLayers -->
  <script src="https://cdn.jsdelivr.net/npm/geotiff@2.1.3/dist-browser/geotiff.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ol@10.7.0/dist/ol.js"></script>
  <script src="map.js"></script>
</body>
</html>
